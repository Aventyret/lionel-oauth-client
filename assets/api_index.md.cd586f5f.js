import{_ as n,c as s,o as a,a as e}from"./app.f5eb41e9.js";const g='{"title":"API Documentation","description":"","frontmatter":{"title":"API Documentation"},"headers":[{"level":2,"title":"Initialize the client","slug":"initialize-the-client"},{"level":2,"title":"Configuration","slug":"configuration"},{"level":2,"title":"Client Methods","slug":"client-methods"},{"level":3,"title":"handleCallback","slug":"handlecallback"},{"level":3,"title":"signIn","slug":"signin"},{"level":3,"title":"signInSilently","slug":"signinsilently"},{"level":3,"title":"getAccessToken","slug":"getaccesstoken"},{"level":3,"title":"getAccessTokenExpires","slug":"getaccesstokenexpires"},{"level":3,"title":"removeAccessToken","slug":"removeaccesstoken"},{"level":3,"title":"getUser","slug":"getuser"},{"level":3,"title":"removeUser","slug":"removeuser"},{"level":3,"title":"signOut","slug":"signout"},{"level":2,"title":"Events","slug":"events"},{"level":3,"title":"tokenLoaded","slug":"tokenloaded"},{"level":3,"title":"tokenUnloaded","slug":"tokenunloaded"},{"level":3,"title":"userLoaded","slug":"userloaded"},{"level":3,"title":"userUnloaded","slug":"userunloaded"},{"level":3,"title":"tokenWillExpire (coming soon)","slug":"tokenwillexpire-coming-soon"},{"level":3,"title":"tokenDidExpire (coming soon)","slug":"tokendidexpire-coming-soon"}],"relativePath":"api/index.md"}',t={},o=e(`<h1 id="api-documentation" tabindex="-1">API Documentation <a class="header-anchor" href="#api-documentation" aria-hidden="true">#</a></h1><h2 id="initialize-the-client" tabindex="-1">Initialize the client <a class="header-anchor" href="#initialize-the-client" aria-hidden="true">#</a></h2><p>The library exposes two factory functions \u2013 createOauthClient for basic oAuth with Authorization Code Grant and the PKCE extension and createOidcClient if you want to leverage OIDC (also with code flow + PCKE).</p><h4 id="createoauthclient" tabindex="-1">createOauthClient <a class="header-anchor" href="#createoauthclient" aria-hidden="true">#</a></h4><div class="language-ts"><pre><code><span class="token keyword">function</span> <span class="token function">createOauthClient</span><span class="token punctuation">(</span>configArg<span class="token operator">:</span> OauthClientConfig<span class="token punctuation">)</span><span class="token operator">:</span> OauthClient
</code></pre></div><p>Basic example:</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createOauthClient <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;lionel-oauth-client&#39;</span>

<span class="token keyword">const</span> oAuthClient <span class="token operator">=</span> <span class="token function">createOauthClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">issuer</span><span class="token operator">:</span> <span class="token string">&#39;https://sso.example.com&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">clientId</span><span class="token operator">:</span> <span class="token string">&#39;my_client_id&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">redirectUri</span><span class="token operator">:</span> <span class="token string">&#39;https://example.com/oauth-callback.html&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">scopes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;api&#39;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="createoidcclient" tabindex="-1">createOidcClient <a class="header-anchor" href="#createoidcclient" aria-hidden="true">#</a></h4><div class="language-ts"><pre><code><span class="token keyword">function</span> <span class="token function">createOidcClient</span><span class="token punctuation">(</span>configArg<span class="token operator">:</span> OauthClientConfig<span class="token punctuation">)</span><span class="token operator">:</span> OauthClient
</code></pre></div><p>Basic example:</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createOidcClient <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;lionel-oauth-client&#39;</span>

<span class="token keyword">const</span> oAuthClient <span class="token operator">=</span> <span class="token function">createOidcClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">issuer</span><span class="token operator">:</span> <span class="token string">&#39;https://sso.example.com&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">clientId</span><span class="token operator">:</span> <span class="token string">&#39;my_client_id&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">redirectUri</span><span class="token operator">:</span> <span class="token string">&#39;https://example.com/oauth-callback.html&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">scopes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;api&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;profile&#39;</span><span class="token punctuation">]</span> <span class="token comment">// Note: &#39;openid&#39; scope will be added automatically</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Both factory functions take an <code>OauthClientConfig</code> object as arguments, but they set default options on that object differently. When you create a client you should be consistent in what config options you use so they are always the same for the same client. See the Configuration section below for a complete list of options.</p><p>The factory functions also return the same type of object, of the type <code>OauthClient</code>:</p><div class="language-ts"><pre><code><span class="token keyword">interface</span> <span class="token class-name">OauthClient</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">signIn</span><span class="token operator">:</span> <span class="token punctuation">(</span>options<span class="token operator">:</span> SignInOptions<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span>
  <span class="token function-variable function">signInSilently</span><span class="token operator">:</span> <span class="token punctuation">(</span>
    options<span class="token operator">:</span> SignInOptions
  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>HandleCallbackResponse <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span>
  <span class="token function-variable function">handleCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>HandleCallbackResponse <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span>
  <span class="token function-variable function">getConfig</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> OauthClientConfig
  <span class="token function-variable function">getAccessToken</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span>
  <span class="token function-variable function">removeAccessToken</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
  subscribe<span class="token operator">:</span> EventSubscribeFn
  unsubscribe<span class="token operator">:</span> EventSubscribeFn
  <span class="token function-variable function">getUser</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>User <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span>
  <span class="token function-variable function">getUserInfo</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>User <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span>
  <span class="token function-variable function">removeUser</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
  <span class="token function-variable function">signOut</span><span class="token operator">:</span> <span class="token punctuation">(</span>options<span class="token operator">:</span> SignOutOptions<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>See the Client Methods section below for a specification of the methods of the <code>OauthClient</code>.</p><h2 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-hidden="true">#</a></h2><p>Configuration of the client is handled by the config options you send as a <code>OauthClientConfig</code> object into the factory functions <code>createOauthClient</code> and <code>createOidcClient</code>.</p><div class="language-ts"><pre><code><span class="token keyword">interface</span> <span class="token class-name">OauthClientConfig</span> <span class="token punctuation">{</span>
  issuer<span class="token operator">:</span> <span class="token builtin">string</span>
  clientId<span class="token operator">:</span> <span class="token builtin">string</span>
  redirectUri<span class="token operator">:</span> <span class="token builtin">string</span>
  scopes<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  authorizationEndpoint<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  tokenEndpoint<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  tokenStorage<span class="token operator">?</span><span class="token operator">:</span> StorageModuleType
  tokenLeewaySeconds<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>
  authenticationMaxAgeSeconds<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>
  signInSilentlyTimeoutSeconds<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>
  autoRenewToken<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
  responseMode<span class="token operator">?</span><span class="token operator">:</span> ResponseMode
  metaData<span class="token operator">?</span><span class="token operator">:</span> MetaData
  useNonce<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
  useMetaDataDiscovery<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
  useUserInfoEndpoint<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
  display<span class="token operator">?</span><span class="token operator">:</span> Display
  uiLocales<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  acrValues<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  debug<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Below is a complete list and definitions of these options:</p><h4 id="oauthclientconfig-issuer" tabindex="-1">OauthClientConfig.issuer <a class="header-anchor" href="#oauthclientconfig-issuer" aria-hidden="true">#</a></h4><p>Required <code>string</code>. The url of the oAuth/OIDC issuer (provider).</p><h4 id="oauthclientconfig-clientid" tabindex="-1">OauthClientConfig.clientId <a class="header-anchor" href="#oauthclientconfig-clientid" aria-hidden="true">#</a></h4><p>Required <code>string</code>. The client_id of the issuer client that you want to use.</p><h4 id="oauthclientconfig-redirecturi" tabindex="-1">OauthClientConfig.redirectUri <a class="header-anchor" href="#oauthclientconfig-redirecturi" aria-hidden="true">#</a></h4><p>Required <code>string</code>. Absolute uri where you handle the callback from your issuer. This is where the issuer will send users after authorization.</p><h4 id="oauthclientconfig-scopes" tabindex="-1">OauthClientConfig.scopes <a class="header-anchor" href="#oauthclientconfig-scopes" aria-hidden="true">#</a></h4><p>Optional <code>array</code> of <code>string</code>. The scope that you want to request from the issuer. When you use <code>createOidcClient</code> to create your client <code>openid</code> will always be added to <code>scopes</code>.</p><h4 id="oauthclientconfig-authorizationendpoint" tabindex="-1">OauthClientConfig.authorizationEndpoint <a class="header-anchor" href="#oauthclientconfig-authorizationendpoint" aria-hidden="true">#</a></h4><p>Optional <code>string</code>. The endpoint at the issuer for the authorization request endpoint. Defaults to <code>/authorize</code>, but this property is not used if you use <a href="https://openid.net/specs/openid-connect-discovery-1_0.html" target="_blank" rel="noopener noreferrer">Open ID Discovery</a>, which is enabled by default if you use <code>createOidcClient</code> to create your client.</p><h4 id="oauthclientconfig-tokenendpoint" tabindex="-1">OauthClientConfig.tokenEndpoint <a class="header-anchor" href="#oauthclientconfig-tokenendpoint" aria-hidden="true">#</a></h4><p>Optional <code>string</code>. The endpoint at the issuer for the token request endpoint. Defaults to <code>/token</code>, but this property is not used if you use <a href="https://openid.net/specs/openid-connect-discovery-1_0.html" target="_blank" rel="noopener noreferrer">Open ID Discovery</a>, which is enabled by default if you use <code>createOidcClient</code> to create your client.</p><h4 id="oauthclientconfig-tokenstorage" tabindex="-1">OauthClientConfig.tokenStorage <a class="header-anchor" href="#oauthclientconfig-tokenstorage" aria-hidden="true">#</a></h4><p>Optional <code>string</code> (of type <code>StorageModuleType</code>). Can be <code>local</code> or <code>session</code>, defaults to <code>session</code>. Sets if tokens and other client data is stored in the browser&#39;s <code>sessionStorage</code> or <code>localStorage</code>.</p><h4 id="oauthclientconfig-tokenleewayseconds" tabindex="-1">OauthClientConfig.tokenLeewaySeconds <a class="header-anchor" href="#oauthclientconfig-tokenleewayseconds" aria-hidden="true">#</a></h4><p>Optional <code>number</code>. Defaults to 60. The number of seconds to allow the current time to deviate when validating <code>expires_in</code> in the token response and <code>nbf</code> and <code>exp</code> attributes of jwt tokens.</p><h4 id="oauthclientconfig-authenticationmaxageseconds" tabindex="-1">OauthClientConfig.authenticationMaxAgeSeconds <a class="header-anchor" href="#oauthclientconfig-authenticationmaxageseconds" aria-hidden="true">#</a></h4><p>Optional <code>number</code>. The maximum allowable elapsed time in seconds since the last time the end-user was actively authenticated at the issuer.</p><h4 id="oauthclientconfig-signinsilentlytimeoutseconds" tabindex="-1">OauthClientConfig.signInSilentlyTimeoutSeconds <a class="header-anchor" href="#oauthclientconfig-signinsilentlytimeoutseconds" aria-hidden="true">#</a></h4><p>Optional <code>number</code>. Defaults to 10. Number of seconds to wait for the silent sign in to return before assuming it has failed or timed out.</p><h4 id="oauthclientconfig-autorenewtoken" tabindex="-1">OauthClientConfig.autoRenewToken <a class="header-anchor" href="#oauthclientconfig-autorenewtoken" aria-hidden="true">#</a></h4><p>Optional <code>boolean</code>. Defaults to <code>true</code>. This specifies if a silent signin should be performed before access tokens are expired and removed from the client. The <code>tokenWillExpireSeconds</code> option will decide how far in advance this is done.</p><h4 id="oauthclientconfig-tokenwillexpireseconds" tabindex="-1">OauthClientConfig.tokenWillExpireSeconds <a class="header-anchor" href="#oauthclientconfig-tokenwillexpireseconds" aria-hidden="true">#</a></h4><p>Optional <code>number</code>. Defaults to <code>60</code>. This specifies how long before the token expiry the <code>tokenWillExpire</code> event will be published. This also controls how far in advance tokens will be auto renewed before they expire.</p><h4 id="oauthclientconfig-responsemode" tabindex="-1">OauthClientConfig.responseMode <a class="header-anchor" href="#oauthclientconfig-responsemode" aria-hidden="true">#</a></h4><p>Optional <code>string</code> (of type <code>ResponseMode</code>). Can be <code>fragment</code> or <code>query</code>. This specifies if parameters from the issuer will be send back as a url hash or query variables to the callback page. If not specified, the issuer&#39;s default will be used.</p><h4 id="oauthclientconfig-metadata" tabindex="-1">OauthClientConfig.metaData <a class="header-anchor" href="#oauthclientconfig-metadata" aria-hidden="true">#</a></h4><p>Optional <code>object</code> (of type <code>MetaData</code>). If you do not use <a href="https://openid.net/specs/openid-connect-discovery-1_0.html" target="_blank" rel="noopener noreferrer">Open ID Discovery</a> you can specify the OIDC meta data here. If you use discovery you can also use this option to override specific attributes in the discovery meta data.</p><p>Type definition:</p><div class="language-ts"><pre><code><span class="token keyword">interface</span> <span class="token class-name">MetaData</span> <span class="token punctuation">{</span>
  issuer<span class="token operator">:</span> <span class="token builtin">string</span>
  authorization_endpoint<span class="token operator">:</span> <span class="token builtin">string</span>
  token_endpoint<span class="token operator">:</span> <span class="token builtin">string</span>
  userinfo_endpoint<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  jwks_uri<span class="token operator">:</span> <span class="token builtin">string</span>
  registration_endpoint<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  scopes_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  response_types_supported<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  response_modes_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  grant_types_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  acr_values_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  subject_types_supported<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  id_token_signing_alg_values_supported<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  id_token_encryption_alg_values_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  id_token_encryption_enc_values_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  userinfo_signing_alg_values_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  userinfo_encryption_alg_values_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  userinfo_encryption_enc_values_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  request_object_signing_alg_values_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  request_object_encryption_alg_values_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  request_object_encryption_enc_values_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  token_endpoint_auth_methods_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  token_endpoint_auth_signing_alg_values_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  display_values_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  claim_types_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  claims_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  service_documentation<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  claims_locales_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  ui_locales_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  claims_parameter_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
  request_parameter_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
  request_uri_parameter_supported<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
  require_request_uri_registration<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
  op_policy_uri<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  op_tos_uri<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  check_session_iframe<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  end_session_endpoint<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="oauthclientconfig-usenonce" tabindex="-1">OauthClientConfig.useNonce <a class="header-anchor" href="#oauthclientconfig-usenonce" aria-hidden="true">#</a></h4><p>Optional <code>boolean</code>. Defaults to <code>false</code> if you use <code>createOauthClient</code> and <code>true</code> if you use <code>createOidcClient</code> to create your client. Specifies if a nonce should be included in the authorization request to the issuer. If <code>useNonce</code> is true the client will require the id token to include the nonce and validate it when the callback is handled.</p><h4 id="oauthclientconfig-usemetadatadiscovery" tabindex="-1">OauthClientConfig.useMetaDataDiscovery <a class="header-anchor" href="#oauthclientconfig-usemetadatadiscovery" aria-hidden="true">#</a></h4><p>Optional <code>boolean</code>. Defaults to <code>false</code> if you use <code>createOauthClient</code> and <code>true</code> if you use <code>createOidcClient</code> to create your client. Specifies if the client should look up issuer meta data through <a href="https://openid.net/specs/openid-connect-discovery-1_0.html" target="_blank" rel="noopener noreferrer">Open ID Discovery</a>.</p><h4 id="oauthclientconfig-useuserinfoendpoint" tabindex="-1">OauthClientConfig.useUserInfoEndpoint <a class="header-anchor" href="#oauthclientconfig-useuserinfoendpoint" aria-hidden="true">#</a></h4><p>Optional <code>boolean</code>. Defaults to <code>false</code> if you use <code>createOauthClient</code> and <code>true</code> if you use <code>createOidcClient</code> to create your client. Specifies if the client should request user info from the issuer&#39;s <a href="https://openid.net/specs/openid-connect-core-1_0.html#UserInfo" target="_blank" rel="noopener noreferrer">user info endpoint</a>.</p><h4 id="oauthclientconfig-display" tabindex="-1">OauthClientConfig.display <a class="header-anchor" href="#oauthclientconfig-display" aria-hidden="true">#</a></h4><p>Optional <code>string</code> (of type <code>Display</code>). Can be <code>page</code>, <code>popup</code>, <code>touch</code> or <code>wap</code>, defaults to <code>page</code>. Specifies how the issuer should display the authentication and consent user interface pages to the end-user.</p><h4 id="oauthclientconfig-uilocales" tabindex="-1">OauthClientConfig.uiLocales <a class="header-anchor" href="#oauthclientconfig-uilocales" aria-hidden="true">#</a></h4><p>Optional <code>array</code> of <code>string</code>. End-user&#39;s preferred languages for the user interface at the issuer (e.g. <code>[&#39;sv-SE&#39;, &#39;en&#39;]</code>). Ordered by preference. The issuer should not throw an error if it does not support these, this is only a declaration of preference.</p><h4 id="oauthclientconfig-acrvalues" tabindex="-1">OauthClientConfig.acrValues <a class="header-anchor" href="#oauthclientconfig-acrvalues" aria-hidden="true">#</a></h4><p>Optional <code>array</code> of <code>string</code>. Specifies the acr_values that the issuer is being requested to use for processing this authentication request, with the values appearing in order of preference.</p><h4 id="oauthclientconfig-debug" tabindex="-1">OauthClientConfig.debug <a class="header-anchor" href="#oauthclientconfig-debug" aria-hidden="true">#</a></h4><p>Optional <code>boolean</code>. Defaults to false. If <code>debug</code> is true the client will output verbose logging in the browser console.</p><h2 id="client-methods" tabindex="-1">Client Methods <a class="header-anchor" href="#client-methods" aria-hidden="true">#</a></h2><p>When you have created a client, these are the methods on it that you can call:</p><h3 id="handlecallback" tabindex="-1">handleCallback <a class="header-anchor" href="#handlecallback" aria-hidden="true">#</a></h3><div class="language-ts"><pre><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handleCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>HandleCallbackResponse <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span>
</code></pre></div><p>Process the response from the issuer. This is done on the redirect uri you have specified as <code>redirectUri</code>.</p><p>Basic example:</p><div class="language-js"><pre><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> oAuthClient<span class="token punctuation">.</span><span class="token function">handleCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  location<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span> <span class="token comment">// Set where you want to redirect the user after successful signin</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If the signin in the client fails the promise that the method returns will be rejected. If the user is successfully signed in the promise will resolve with an object of the type <code>HandleCallbackResponse</code>:</p><div class="language-ts"><pre><code><span class="token keyword">interface</span> <span class="token class-name">TokenResponse</span> <span class="token punctuation">{</span>
  accessToken<span class="token operator">:</span> <span class="token builtin">string</span>
  idToken<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  expires<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">HandleCallbackResponse</span> <span class="token punctuation">{</span>
  tokenResponse<span class="token operator">:</span> TokenResponse
  callbackType<span class="token operator">:</span> CallbackType
  user<span class="token operator">:</span> User <span class="token operator">|</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="signin" tabindex="-1">signIn <a class="header-anchor" href="#signin" aria-hidden="true">#</a></h3><div class="language-ts"><pre><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">signIn</span><span class="token punctuation">(</span>options<span class="token operator">:</span> SignInOptions <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span>
</code></pre></div><p>This performs redirect of the current window to the authorization endpoint of the issuer. The method returns a Promise in order to enable error handling of the generating of the redirect.</p><p>Basic example:</p><div class="language-js"><pre><code>oAuthClient<span class="token punctuation">.</span><span class="token function">signIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>The <code>signIn</code> methods take an optional argument of an object of the type <code>SignInOptions</code>:</p><div class="language-ts"><pre><code><span class="token keyword">interface</span> <span class="token class-name">SignInOptions</span> <span class="token punctuation">{</span>
  idTokenHint<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  loginHint<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  display<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  prompts<span class="token operator">?</span><span class="token operator">:</span> Prompt<span class="token punctuation">[</span><span class="token punctuation">]</span>
  nonce<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Below is a complete list and definitions of these options:</p><h4 id="signinoptions-idtokenhint" tabindex="-1">SignInOptions.idTokenHint <a class="header-anchor" href="#signinoptions-idtokenhint" aria-hidden="true">#</a></h4><p>Optional <code>string</code>. Id token previously issued by the issuer being passed as a hint about the end-user&#39;s current or past authenticated session with the client.</p><h4 id="signinoptions-loginhint" tabindex="-1">SignInOptions.loginHint <a class="header-anchor" href="#signinoptions-loginhint" aria-hidden="true">#</a></h4><p>Optional <code>string</code>. This is a hint to the issuer about what identifier the end-user might use to log in (if necessary). For instance if you first ask the end-user for their e-mail address (or other identifier) and then want to pass that value as a hint to the issuer.</p><h4 id="signinoptions-display" tabindex="-1">SignInOptions.display <a class="header-anchor" href="#signinoptions-display" aria-hidden="true">#</a></h4><p>Optional <code>string</code> (of type <code>Display</code>). Can be <code>page</code>, <code>popup</code>, <code>touch</code> or <code>wap</code>, defaults to the <code>display</code> option of the client. Specifies how the issuer should display the authentication and consent user interface pages to the end-user.</p><h4 id="signinoptions-prompts" tabindex="-1">SignInOptions.prompts <a class="header-anchor" href="#signinoptions-prompts" aria-hidden="true">#</a></h4><p>Optional array of <code>string</code> (of type <code>Prompt</code>). Can include <code>none</code>, <code>login</code>, <code>consent</code> or <code>select_account</code>. Specifies whether the issuer prompts the end-user for reauthentication and consent.</p><h4 id="signinoptions-nonce" tabindex="-1">SignInOptions.nonce <a class="header-anchor" href="#signinoptions-nonce" aria-hidden="true">#</a></h4><p>Optional <code>string</code>. Here you can provide your own nonce to send to the issuer. If you leave this empty the client will generate a nonce for you (if <code>useNonce</code> is <code>true</code>).</p><h3 id="signinsilently" tabindex="-1">signInSilently <a class="header-anchor" href="#signinsilently" aria-hidden="true">#</a></h3><div class="language-ts"><pre><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">signInSilently</span><span class="token punctuation">(</span>
  options<span class="token operator">:</span> SignInOptions <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>HandleCallbackResponse <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span>
</code></pre></div><p>This method sign a user in silently, that is without the end user being redirected to the issuer. This will perform an authentication in a hidden iframe, and if a user is signed in at the issuer the user will be signed in in the client.</p><p>Basic example:</p><div class="language-js"><pre><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> signInResponse <span class="token operator">=</span> <span class="token keyword">await</span> oAuthClient<span class="token punctuation">.</span><span class="token function">signInSilently</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;Not signed in&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The method&#39;s argument is the same as for <code>signIn</code>, but the <code>prompts</code> option will always be <code>[&#39;none&#39;]</code>.</p><p>If the method returns a Promise that resolves with a <code>HandleCallbackResponse</code> with a <code>user</code> attribute (or a <code>tokenResponse.accessToken</code> attribute if you do not use OIDC) the user was signed in at the issuer and is now signed in at the provider.</p><h3 id="getaccesstoken" tabindex="-1">getAccessToken <a class="header-anchor" href="#getaccesstoken" aria-hidden="true">#</a></h3><div class="language-ts"><pre><code><span class="token keyword">function</span> <span class="token function">getAccessToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span>
</code></pre></div><p>Get the access token of user that is authenticated in the client. If there is no token the method will return null (and not throw an error).</p><p>Basic example:</p><div class="language-js"><pre><code><span class="token keyword">const</span> accessToken <span class="token operator">=</span> oAuthClient<span class="token punctuation">.</span><span class="token function">getAccessToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="getaccesstokenexpires" tabindex="-1">getAccessTokenExpires <a class="header-anchor" href="#getaccesstokenexpires" aria-hidden="true">#</a></h3><div class="language-ts"><pre><code><span class="token keyword">function</span> <span class="token function">getAccessTokenExpires</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span>
</code></pre></div><p>Get the expires timestamp of the access token in seconds from January 1st, 1970 at UTC. The tokens and the user will be removed from storage at this time if the tokens are not renewed before then.</p><p>Basic example:</p><div class="language-js"><pre><code><span class="token keyword">const</span> accessTokenExpires <span class="token operator">=</span> oAuthClient<span class="token punctuation">.</span><span class="token function">accessTokenExpires</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="removeaccesstoken" tabindex="-1">removeAccessToken <a class="header-anchor" href="#removeaccesstoken" aria-hidden="true">#</a></h3><div class="language-ts"><pre><code><span class="token keyword">function</span> <span class="token function">removeAccessToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><p>Removes the access token (effectively a client side sign out when not using openid scope). This will not sign the user out at the issuer.</p><p>Basic example:</p><div class="language-js"><pre><code><span class="token keyword">await</span> oAuthClient<span class="token punctuation">.</span><span class="token function">removeAccessToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="getuser" tabindex="-1">getUser <a class="header-anchor" href="#getuser" aria-hidden="true">#</a></h3><div class="language-ts"><pre><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>User <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span>
</code></pre></div><p>Get the decoded user claims from id_token and from the latest UserInfo response if a UserInfo request has been made. If there is no user the Promise that the method returns will resolve with <code>null</code>.</p><p>Basic example:</p><div class="language-js"><pre><code><span class="token keyword">let</span> user
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  user <span class="token operator">=</span> <span class="token keyword">await</span> oAuthClient<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>What the user object looks like will depend on what claims the issuer returns. The type definition look like this:</p><h3 id="removeuser" tabindex="-1">removeUser <a class="header-anchor" href="#removeuser" aria-hidden="true">#</a></h3><div class="language-ts"><pre><code><span class="token keyword">function</span> <span class="token function">removeUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><p>Removes the access token and id token (effectively a client side sign out). This will not sign the user out at the issuer.</p><p>Basic example:</p><div class="language-js"><pre><code>oAuthClient<span class="token punctuation">.</span><span class="token function">removeUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="signout" tabindex="-1">signOut <a class="header-anchor" href="#signout" aria-hidden="true">#</a></h3><div class="language-ts"><pre><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">signOut</span><span class="token punctuation">(</span>options<span class="token operator">:</span> SignOutOptions<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span>
</code></pre></div><p>Signs out user both in client and in issuer (and will redirect the user to the issuer). This requires end_session_endpoint in meta data (or in the issuer&#39;s discovery meta data).</p><p>Basic example:</p><div class="language-js"><pre><code>oAuthClient<span class="token punctuation">.</span><span class="token function">signOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>The <code>signOut</code> methods take an optional argument of an object of the type <code>SignOutOptions</code>:</p><div class="language-ts"><pre><code><span class="token keyword">interface</span> <span class="token class-name">SignOutOptions</span> <span class="token punctuation">{</span>
  postLogoutRedirectUri<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  useIdTokenHint<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Below is a complete list and definitions of these options:</p><h4 id="signoutoptions-postlogoutredirecturi" tabindex="-1">SignOutOptions.postLogoutRedirectUri <a class="header-anchor" href="#signoutoptions-postlogoutredirecturi" aria-hidden="true">#</a></h4><p>Optional <code>string</code>. Absolute uri where the issuer should redirect the end-user after signing them out. This requires an id token hint to be sent, so it is only possible if you use OIDC.</p><h4 id="signoutoptions-useidtokenhint" tabindex="-1">SignOutOptions.useIdTokenHint <a class="header-anchor" href="#signoutoptions-useidtokenhint" aria-hidden="true">#</a></h4><p>Optional <code>boolean</code>. Defaults to <code>false</code> but if you provide a <code>postLogoutRedirectUri</code> this will be true, since the open id specification requires this. This option specifies if the current id token in the client should be passed as a hint about the end-user&#39;s current or past authenticated session with the client.</p><h2 id="events" tabindex="-1">Events <a class="header-anchor" href="#events" aria-hidden="true">#</a></h2><p>The client publishes events when things that has to do with authentication happens that you can subscribe to.</p><p>Subscribe to an event to trigger a function in response:</p><div class="language-js"><pre><code><span class="token comment">/** Supported event types: &quot;tokenLoaded&quot;, &quot;tokenUnloaded&quot;, &quot;userLoaded&quot;, &quot;userUnloaded&quot;, &quot;tokenWillExpire&quot;, &quot;tokenDidExpire&quot; */</span>
oAuthClient<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">&#39;tokenLoaded&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;An access token was loaded&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><p>To unsubscribe from an event, you must provide the same function that was passed to <code>oAuthClient.subscribe</code>:</p><div class="language-js"><pre><code><span class="token comment">/** Supported event types: &quot;tokenLoaded&quot;, &quot;tokenUnloaded&quot;, &quot;userLoaded&quot;, &quot;userUnloaded&quot;, &quot;tokenWillExpire&quot;, &quot;tokenDidExpire&quot; */</span>
oAuthClient<span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token string">&#39;tokenLoaded&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;An access token was loaded&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><p>The events that you can subscribe on are:</p><h3 id="tokenloaded" tabindex="-1">tokenLoaded <a class="header-anchor" href="#tokenloaded" aria-hidden="true">#</a></h3><p>This event is published when an access token is loaded in the client, it can be either when it is retreived from the callback response or when it is loaded from the token storage in the browser.</p><p>The payload of the event is the access token:</p><div class="language-ts"><pre><code><span class="token keyword">function</span> <span class="token function">exampleTokenLoadedListener</span><span class="token punctuation">(</span>accessToken<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><h3 id="tokenunloaded" tabindex="-1">tokenUnloaded <a class="header-anchor" href="#tokenunloaded" aria-hidden="true">#</a></h3><p>This event is published when an access token is unloaded in the client, it can be either after it has been expired or when it is removed with any of the methods <code>removeAccessToken</code>, <code>removeUser</code> or <code>signOut</code>.</p><p>The event has no payload:</p><div class="language-ts"><pre><code><span class="token keyword">function</span> <span class="token function">exampleTokenUnloadedListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><h3 id="userloaded" tabindex="-1">userLoaded <a class="header-anchor" href="#userloaded" aria-hidden="true">#</a></h3><p>This event is published when a user is loaded in the client, it can be either when it is retreived from the callback response or when it is loaded from the token storage in the browser.</p><p>The payload of the event is the user:</p><div class="language-ts"><pre><code><span class="token keyword">function</span> <span class="token function">exampleUserLoadedListener</span><span class="token punctuation">(</span>user<span class="token operator">:</span> User<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><h3 id="userunloaded" tabindex="-1">userUnloaded <a class="header-anchor" href="#userunloaded" aria-hidden="true">#</a></h3><p>This event is published when a user is unloaded in the client, it can be either after the access token has been expired or when the user is removed with any of the methods <code>removeUser</code> or <code>signOut</code>.</p><p>The event has no payload:</p><div class="language-ts"><pre><code><span class="token keyword">function</span> <span class="token function">exampleUserUnloadedListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><h3 id="tokenwillexpire-coming-soon" tabindex="-1">tokenWillExpire (coming soon) <a class="header-anchor" href="#tokenwillexpire-coming-soon" aria-hidden="true">#</a></h3><p>This event is published before the access token in the client will expire.</p><p>The event has no payload:</p><div class="language-ts"><pre><code><span class="token keyword">function</span> <span class="token function">exampleTokenWillExpireListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><h3 id="tokendidexpire-coming-soon" tabindex="-1">tokenDidExpire (coming soon) <a class="header-anchor" href="#tokendidexpire-coming-soon" aria-hidden="true">#</a></h3><p>This event is published after the access token in the client has expired.</p><p>The event has no payload:</p><div class="language-ts"><pre><code><span class="token keyword">function</span> <span class="token function">exampleTokenDidExpireListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div>`,166),p=[o];function i(c,r,l,u,d,k){return a(),s("div",null,p)}var f=n(t,[["render",i]]);export{g as __pageData,f as default};
